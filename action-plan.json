[
  {
    "id": "migrate-1-analyze-next-app",
    "title": "Analyze existing Next.js app and document architecture",
    "description": "Inspect the current Next.js project, list routes, data fetching patterns, shared layouts, and API routes. Produce a document that will guide the Astro migration.",
    "context": {
      "goal": "Understand the current Next.js app structure so the migration to Astro can be planned without missing important features.",
      "notes": [
        "Identify whether the app uses Pages Router (pages/) or App Router (app/).",
        "List all pages and their URLs.",
        "Identify which pages use getStaticProps, getServerSideProps, getStaticPaths, or route handlers.",
        "List all API routes (pages/api/* or app/api/*).",
        "Note any global layout, SEO handling, and providers (e.g., _app.tsx, _document.tsx, layout.tsx)."
      ]
    },
    "dependencies": [],
    "artifacts": [
      {
        "path": "docs/migration-architecture.md",
        "type": "markdown",
        "required_sections": [
          "Route Inventory",
          "Data Fetching Overview",
          "API Routes Inventory",
          "Layouts and SEO",
          "Migration Strategy Overview"
        ]
      }
    ],
    "commands": [],
    "verification": [
      "docs/migration-architecture.md exists.",
      "The document lists all current routes and their behavior (static/SSR/dynamic).",
      "API routes are inventoried and categorized by complexity.",
      "Global layout and SEO patterns are described."
    ],
    "status": "pending"
  },
  {
    "id": "migrate-2-init-astro-project",
    "title": "Initialize new Astro project",
    "description": "Create a new Astro project (astro-app) with TypeScript and React integration.",
    "context": {
      "goal": "Have a fresh Astro project that will become the new frontend, independent from Next.js.",
      "constraints": [
        "Project root for Astro is astro-app/.",
        "TypeScript must be enabled.",
        "React integration will be added next."
      ]
    },
    "dependencies": ["migrate-1-analyze-next-app"],
    "artifacts": [
      { "path": "astro-app/package.json", "type": "json", "required": true },
      { "path": "astro-app/astro.config.mjs", "type": "javascript", "required": true },
      { "path": "astro-app/tsconfig.json", "type": "json", "required": true },
      { "path": "astro-app/src/pages/index.astro", "type": "astro", "required": true }
    ],
    "commands": [
      {
        "description": "Create the Astro project in astro-app/",
        "run": "npm create astro@latest astro-app -- --template basics --typescript"
      },
      {
        "description": "Run the Astro dev server",
        "run": "cd astro-app && npm install && npm run dev"
      }
    ],
    "verification": [
      "Astro dev server starts successfully and serves a default index page.",
      "TypeScript is enabled (tsconfig.json present)."
    ],
    "status": "pending"
  },
  {
    "id": "migrate-3-add-react-integration",
    "title": "Add React integration to Astro",
    "description": "Configure Astro to support React components as islands by installing and enabling @astrojs/react.",
    "context": {
      "goal": "Allow reuse of existing React components from the Next.js app inside Astro pages.",
      "notes": [
        "React will be used for interactive parts; Astro will provide routing and overall page structure."
      ]
    },
    "dependencies": ["migrate-2-init-astro-project"],
    "artifacts": [
      { "path": "astro-app/astro.config.mjs", "type": "javascript", "required": true }
    ],
    "commands": [
      {
        "description": "Install and configure React integration",
        "run": "cd astro-app && npm install @astrojs/react && npx astro add react"
      }
    ],
    "verification": [
      "astro.config.mjs includes the React integration plugin.",
      "A simple React component can be rendered in an .astro page using client directives (e.g., client:load)."
    ],
    "status": "pending"
  },
  {
    "id": "migrate-4-setup-tailwind-and-global-styles",
    "title": "Configure Tailwind and global styles in Astro",
    "description": "If the Next.js app uses Tailwind or global CSS, configure Tailwind and import global styles in astro-app.",
    "context": {
      "goal": "Ensure styling patterns from the Next.js app can be reused in Astro.",
      "notes": [
        "If Tailwind is used in Next.js, mirror the configuration here.",
        "Make sure Tailwind content paths include .astro and .tsx files in astro-app."
      ]
    },
    "dependencies": ["migrate-2-init-astro-project"],
    "artifacts": [
      { "path": "astro-app/tailwind.config.cjs or tailwind.config.ts", "type": "javascript", "required": false },
      { "path": "astro-app/src/styles/global.css", "type": "css", "required": false }
    ],
    "commands": [
      {
        "description": "Add Tailwind to Astro (if using Tailwind)",
        "run": "cd astro-app && npx astro add tailwind",
        "optional": true
      }
    ],
    "verification": [
      "Tailwind configuration exists if it was used in the Next.js app.",
      "Global styles from Next.js are either copied or re-created in Astro and imported in a layout or root.",
      "Tailwind classes render correctly in Astro pages/React components."
    ],
    "status": "pending"
  },
  {
    "id": "migrate-5-create-base-layout-in-astro",
    "title": "Create a base layout in Astro mirroring Next.js layout",
    "description": "Implement a main layout in Astro that replicates the structure and SEO meta tags of the existing Next.js layout/_app.",
    "context": {
      "goal": "Provide a common layout shell in Astro for all pages, similar to Next.js _app.tsx or layout.tsx.",
      "notes": [
        "Include <html>, <head>, and <body> structure if using a root layout.",
        "Expose props for title/meta where needed."
      ]
    },
    "dependencies": ["migrate-1-analyze-next-app", "migrate-2-init-astro-project"],
    "artifacts": [
      { "path": "astro-app/src/layouts/MainLayout.astro", "type": "astro", "required": true }
    ],
    "commands": [],
    "verification": [
      "MainLayout.astro exists and includes head/meta tags similar to the Next layout.",
      "Index page uses the layout and renders without errors."
    ],
    "status": "pending"
  },
  {
    "id": "migrate-6-migrate-shared-react-components",
    "title": "Migrate shared React components from Next.js to Astro",
    "description": "Copy reusable React components from the Next.js app into astro-app/src/react/components and adjust imports to remove Next-specific dependencies.",
    "context": {
      "goal": "Preserve reusable UI elements and logic from the Next.js app as React components in the Astro project.",
      "notes": [
        "Remove or replace next/link and next/image with standard elements or Astro equivalents.",
        "Keep styling (CSS, Tailwind) intact where possible."
      ]
    },
    "dependencies": ["migrate-3-add-react-integration", "migrate-4-setup-tailwind-and-global-styles"],
    "artifacts": [
      { "path": "astro-app/src/react/components", "type": "directory", "required": true }
    ],
    "commands": [],
    "verification": [
      "Core shared components (buttons, cards, layout pieces, etc.) are available under astro-app/src/react/components.",
      "Imports using next/link or next/image are replaced with appropriate alternatives.",
      "These components can be imported into an Astro page and rendered via client directives without runtime errors."
    ],
    "status": "pending"
  },
  {
    "id": "migrate-7-migrate-page-components-to-react-pages",
    "title": "Extract Next.js page components into React page components",
    "description": "For each significant Next.js page, create a corresponding React component under astro-app/src/react/pages that encapsulates the page UI (without Next data-fetching functions).",
    "context": {
      "goal": "Separate UI from data-fetching logic so Astro can handle data loading while React handles UI.",
      "notes": [
        "Move TSX from Next pages into React components like HomePage, ReportsPage, etc.",
        "Strip out getStaticProps/getServerSideProps from these components (they will be handled in Astro)."
      ]
    },
    "dependencies": ["migrate-6-migrate-shared-react-components"],
    "artifacts": [
      { "path": "astro-app/src/react/pages", "type": "directory", "required": true }
    ],
    "commands": [],
    "verification": [
      "For each key Next.js page, there is a corresponding React page component in astro-app/src/react/pages.",
      "These components do not import Next-specific functions (getStaticProps, etc.).",
      "Components compile and can be rendered inside a test Astro page."
    ],
    "status": "pending"
  },
  {
    "id": "migrate-8-create-astro-pages-and-route-mapping",
    "title": "Create Astro pages that mirror Next.js routes",
    "description": "For each Next.js route, create a corresponding .astro file in astro-app/src/pages that uses the MainLayout, performs data loading in frontmatter, and renders the appropriate React page component.",
    "context": {
      "goal": "Replicate the Next.js routing structure in Astro so URLs and page content remain consistent.",
      "notes": [
        "Use docs/migration-architecture.md route inventory as the source of truth.",
        "For dynamic routes, implement Astro getStaticPaths where needed."
      ]
    },
    "dependencies": ["migrate-5-create-base-layout-in-astro", "migrate-7-migrate-page-components-to-react-pages"],
    "artifacts": [
      { "path": "astro-app/src/pages", "type": "directory", "required": true }
    ],
    "commands": [],
    "verification": [
      "For each original Next.js route, there is a corresponding .astro page.",
      "Each .astro page imports MainLayout and the relevant React page component, and renders it using client directives where necessary.",
      "Static routes work; dynamic routes correctly receive params via Astro.params.",
      "Basic navigation between pages behaves as expected."
    ],
    "status": "pending"
  },
  {
    "id": "migrate-9-migrate-data-fetching-logic",
    "title": "Migrate data fetching from getStaticProps/getServerSideProps to Astro frontmatter",
    "description": "Refactor data fetching logic previously in Next.js getStaticProps/getServerSideProps/getStaticPaths into shared lib functions and call them from Astro page frontmatter.",
    "context": {
      "goal": "Keep data-loading behavior equivalent while using Astro's server-side frontmatter and getStaticPaths APIs.",
      "notes": [
        "Move shared data fetch logic into astro-app/src/lib (e.g., lib/reports.ts).",
        "Astro frontmatter can use await to fetch data.",
        "Dynamic pages may need getStaticPaths to generate routes at build time."
      ]
    },
    "dependencies": ["migrate-1-analyze-next-app", "migrate-8-create-astro-pages-and-route-mapping"],
    "artifacts": [
      { "path": "astro-app/src/lib", "type": "directory", "required": true }
    ],
    "commands": [],
    "verification": [
      "No React components depend on getStaticProps or getServerSideProps directly.",
      "Data-fetching logic lives in astro-app/src/lib and is called from .astro frontmatter.",
      "Pages that were previously static/SSR behave the same in Astro (same data rendered for the same URL)."
    ],
    "status": "pending"
  },
  {
    "id": "migrate-10-inventory-and-decide-api-strategy",
    "title": "Inventory Next.js API routes and decide migration strategy",
    "description": "Review all Next.js API routes and decide which ones to move into Astro endpoints and which ones to keep or move into a separate backend service.",
    "context": {
      "goal": "Have a clear plan for handling API endpoints currently in Next.js.",
      "notes": [
        "Some APIs may be tightly coupled to the frontend and can move into Astro.",
        "More complex or long-running APIs may be better as a standalone backend service."
      ]
    },
    "dependencies": ["migrate-1-analyze-next-app"],
    "artifacts": [
      {
        "path": "docs/migration-architecture.md",
        "type": "markdown",
        "required_sections": ["API Migration Plan"]
      }
    ],
    "commands": [],
    "verification": [
      "API routes are categorized into: move-to-Astro, keep-as-backend, or deprecated.",
      "docs/migration-architecture.md documents the chosen approach for each route or group."
    ],
    "status": "pending"
  },
  {
    "id": "migrate-11-implement-astro-api-endpoints",
    "title": "Implement simple API endpoints in Astro",
    "description": "For API routes selected to move into Astro, create corresponding endpoint files in astro-app/src/pages/api and implement logic using shared utilities.",
    "context": {
      "goal": "Provide equivalent API functionality via Astro endpoints for routes simple enough to move.",
      "notes": [
        "Astro endpoints return Response objects.",
        "Use shared lib functions for business logic to avoid duplication."
      ]
    },
    "dependencies": ["migrate-10-inventory-and-decide-api-strategy"],
    "artifacts": [
      { "path": "astro-app/src/pages/api", "type": "directory", "required": false }
    ],
    "commands": [],
    "verification": [
      "Astro API endpoints exist for each selected route.",
      "Frontend code that relied on these endpoints now points to the Astro equivalents (paths and behavior match).",
      "Endpoints return correct JSON and status codes."
    ],
    "status": "pending"
  },
  {
    "id": "migrate-12-migrate-styling-and-assets",
    "title": "Migrate all styling and static assets to Astro",
    "description": "Move global CSS, Tailwind config, and static assets (images, fonts, etc.) from Next.js to Astro, and ensure all visual aspects match the original app.",
    "context": {
      "goal": "Ensure the Astro app looks visually identical (or close) to the original Next.js app.",
      "notes": [
        "Public assets in Next.js (/public) should be moved to astro-app/public.",
        "Check that paths referenced in code and CSS are still valid."
      ]
    },
    "dependencies": ["migrate-4-setup-tailwind-and-global-styles"],
    "artifacts": [
      { "path": "astro-app/public", "type": "directory", "required": true },
      { "path": "astro-app/src/styles", "type": "directory", "required": false }
    ],
    "commands": [],
    "verification": [
      "All images, icons, and fonts used in the Next.js app are available in astro-app/public.",
      "Global styles are applied and pages visually match the Next.js version.",
      "No broken asset URLs in the browser console."
    ],
    "status": "pending"
  },
  {
    "id": "migrate-13-page-by-page-visual-and-functional-QA",
    "title": "Compare Astro pages with original Next.js pages",
    "description": "Manually or semi-automatically compare each migrated Astro page against the original Next.js page to ensure that content, layout, and core interactions match.",
    "context": {
      "goal": "Validate that the migration preserved user-facing behavior and layout.",
      "notes": [
        "Focus on critical flows first (home page, main lists, detail pages).",
        "Check SEO-relevant elements (title, meta, canonical) where applicable."
      ]
    },
    "dependencies": ["migrate-8-create-astro-pages-and-route-mapping", "migrate-9-migrate-data-fetching-logic", "migrate-12-migrate-styling-and-assets"],
    "artifacts": [
      { "path": "docs/migration-checklist.md", "type": "markdown", "required_sections": ["Page QA Results"] }
    ],
    "commands": [],
    "verification": [
      "For each important route, docs/migration-checklist.md notes that the Astro page has been checked and is acceptable or highlights deviations.",
      "No major functional regressions in navigation or data display for key pages."
    ],
    "status": "pending"
  },
  {
    "id": "migrate-14-remove-next-specific-dependencies-and-code",
    "title": "Remove unused Next.js-specific code and dependencies",
    "description": "Once the Astro app is validated, remove Next.js-specific files and dependencies (next, next/link, next/image, next.config.js, etc.) from the repo, or archive the old project if kept for reference.",
    "context": {
      "goal": "Clean up the codebase so Astro is the only frontend framework in use.",
      "notes": [
        "If you want to keep a record of the Next.js app, you can move it to an archive directory or separate branch.",
        "Update package.json to remove Next-related dependencies if not used elsewhere."
      ]
    },
    "dependencies": ["migrate-13-page-by-page-visual-and-functional-QA"],
    "artifacts": [
      { "path": "next-app", "type": "directory", "required": false },
      { "path": "package.json", "type": "json", "required": true }
    ],
    "commands": [],
    "verification": [
      "No references to 'next', 'next/link', or 'next/image' remain in the active codebase.",
      "Next.js-specific config files (next.config.js, next-env.d.ts) are removed or quarantined.",
      "The Astro app builds and runs without any Next.js dependencies."
    ],
    "status": "pending"
  },
  {
    "id": "migrate-15-update-deployment-config",
    "title": "Update deployment configuration to use Astro app",
    "description": "Adjust deployment scripts, CI/CD pipelines, and hosting configuration to deploy the Astro app instead of the Next.js app.",
    "context": {
      "goal": "Ensure the production environment serves the Astro app and no longer depends on the Next.js build.",
      "notes": [
        "If using a platform like Vercel or Netlify, update the project settings to point to astro-app.",
        "Update build and start commands in deployment configuration."
      ]
    },
    "dependencies": ["migrate-14-remove-next-specific-dependencies-and-code"],
    "artifacts": [
      { "path": ".github/workflows", "type": "directory", "required": false },
      { "path": "vercel.json", "type": "json", "required": false },
      { "path": "netlify.toml", "type": "toml", "required": false }
    ],
    "commands": [],
    "verification": [
      "CI/CD pipelines build and deploy the Astro app successfully.",
      "Production URL now serves the Astro app.",
      "No deployment step tries to build or run the old Next.js app."
    ],
    "status": "pending"
  }
]