[
  {
    "id": "dash-1-init-next-app",
    "title": "Initialize Next.js dashboard app with TypeScript and Tailwind",
    "description": "Create a Next.js App Router project inside apps/dashboard, enable TypeScript and Tailwind CSS, and prepare a basic layout structure. This app is only responsible for the dashboard (UI + HTTP APIs), not for generator logic.",
    "context": {
      "goal": "Set up a modern, flexible frontend environment for the dashboard under apps/dashboard, separate from the generator app.",
      "constraints": [
        "Use App Router (app/ directory).",
        "Enable TypeScript.",
        "Tailwind must be configured.",
        "The app should not depend directly on apps/generator; only on packages/*."
      ]
    },
    "dependencies": [],
    "artifacts": [
      { "path": "apps/dashboard/package.json", "type": "json", "required": true },
      { "path": "apps/dashboard/app/layout.tsx", "type": "typescript", "required": true },
      { "path": "apps/dashboard/app/page.tsx", "type": "typescript", "required": true },
      { "path": "apps/dashboard/tailwind.config.ts", "type": "typescript", "required": true },
      { "path": "apps/dashboard/postcss.config.mjs", "type": "javascript", "required": true }
    ],
    "commands": [
      {
        "description": "Create Next.js app in apps/dashboard",
        "run": "cd apps && npx create-next-app@latest dashboard --typescript --app --eslint --tailwind"
      },
      {
        "description": "Run dev server for dashboard",
        "run": "cd apps/dashboard && npm run dev"
      }
    ],
    "verification": [
      "The dashboard dev server starts successfully and serves a basic Next.js page at http://localhost:3000.",
      "Tailwind classes used in apps/dashboard/app/page.tsx are rendered correctly."
    ],
    "status": "completed"
  },
  {
    "id": "dash-2-install-shadcn",
    "title": "Install and configure shadcn/ui in the dashboard app",
    "description": "Integrate shadcn/ui into apps/dashboard to provide a cohesive, extensible UI component library.",
    "context": {
      "goal": "Use shadcn/ui for consistent, composable UI components in the dashboard only, without affecting the generator.",
      "notes": [
        "Components will be generated into apps/dashboard/components/ui.",
        "shadcn/ui sits on top of Tailwind and Radix."
      ]
    },
    "dependencies": ["dash-1-init-next-app"],
    "artifacts": [
      { "path": "apps/dashboard/components/ui/button.tsx", "type": "typescript", "required": true },
      { "path": "apps/dashboard/components/ui/input.tsx", "type": "typescript", "required": false },
      { "path": "apps/dashboard/components/ui/card.tsx", "type": "typescript", "required": false }
    ],
    "commands": [
      {
        "description": "Initialize shadcn/ui in apps/dashboard",
        "run": "cd apps/dashboard && npx shadcn-ui@latest init"
      },
      {
        "description": "Add base components for dashboard UI",
        "run": "cd apps/dashboard && npx shadcn-ui@latest add button input card form"
      }
    ],
    "verification": [
      "shadcn configuration files (e.g., components.json) exist in apps/dashboard.",
      "A shadcn Button can be imported and rendered in apps/dashboard/app/page.tsx.",
      "Styles render correctly with Tailwind in the dashboard."
    ],
    "status": "completed"
  },
  {
    "id": "dash-3-setup-shared-prisma-client",
    "title": "Set up shared Prisma schema and client in packages/db",
    "description": "Configure a shared Prisma schema and client under packages/db so both apps/generator and apps/dashboard can use the same database definition. The dashboard will import the client from this package, not define its own schema.",
    "context": {
      "goal": "Centralize DB schema and client in packages/db, so generation and dashboard can be deployed independently but share the same data model.",
      "constraints": [
        "Prisma schema lives in packages/db/prisma/schema.prisma.",
        "Prisma client is created in packages/db/src/client.ts and exported.",
        "apps/dashboard must only import from packages/db, not manage its own schema."
      ]
    },
    "dependencies": [],
    "artifacts": [
      { "path": "packages/db/prisma/schema.prisma", "type": "prisma", "required": true },
      { "path": "packages/db/src/client.ts", "type": "typescript", "required": true },
      { "path": "packages/db/package.json", "type": "json", "required": true }
    ],
    "commands": [
      {
        "description": "Generate Prisma client in packages/db",
        "run": "cd packages/db && npx prisma generate"
      }
    ],
    "verification": [
      "packages/db/prisma/schema.prisma contains the shared schema used by both generator and dashboard.",
      "packages/db/src/client.ts exports a singleton Prisma client.",
      "From apps/dashboard, importing the client from packages/db works (type checks, no runtime errors)."
    ],
    "status": "completed"
  },
  {
    "id": "dash-4-integrate-prisma-in-dashboard",
    "title": "Integrate shared Prisma client into the dashboard app",
    "description": "Wire the shared Prisma client from packages/db into apps/dashboard, and create a small data test to confirm queries work from the dashboard environment.",
    "context": {
      "goal": "Allow Next.js server components and API routes in apps/dashboard to query the DB through packages/db.",
      "constraints": [
        "No direct Prisma schema in apps/dashboard.",
        "All DB imports must come from packages/db."
      ]
    },
    "dependencies": ["dash-3-setup-shared-prisma-client"],
    "artifacts": [
      { "path": "apps/dashboard/lib/db-test.ts", "type": "typescript", "required": false }
    ],
    "commands": [
      {
        "description": "Run a small test route or script to verify DB connectivity",
        "run": "cd apps/dashboard && npm run dev"
      }
    ],
    "verification": [
      "A simple test route or script in apps/dashboard can call Prisma client from packages/db and run a basic query (e.g., count users).",
      "No multiple-client warnings during hot reload (singleton pattern works)."
    ],
    "status": "completed"
  },
  {
    "id": "dash-5-setup-authjs",
    "title": "Configure Auth.js (NextAuth) in apps/dashboard with Prisma adapter from packages/db",
    "description": "Set up Auth.js for apps/dashboard using Prisma adapter that points to the shared schema in packages/db, enabling login and sessions for dashboard users.",
    "context": {
      "goal": "Provide authentication and session handling solely in apps/dashboard, while reusing the shared user model in packages/db.",
      "constraints": [
        "Auth route must be located at apps/dashboard/app/api/auth/[...nextauth]/route.ts.",
        "Use Prisma adapter configured with the client from packages/db.",
        "User data remains in shared DB; only dashboard owns the auth UI and routes."
      ]
    },
    "dependencies": ["dash-4-integrate-prisma-in-dashboard"],
    "artifacts": [
      { "path": "apps/dashboard/app/api/auth/[...nextauth]/route.ts", "type": "typescript", "required": true },
      { "path": "apps/dashboard/lib/auth.ts", "type": "typescript", "required": true },
      { "path": ".env.example", "type": "env", "required_keys": ["AUTH_SECRET"] }
    ],
    "commands": [
      {
        "description": "Install Auth.js dependencies in dashboard",
        "run": "cd apps/dashboard && npm install next-auth @auth/prisma-adapter"
      }
    ],
    "verification": [
      "Visiting a protected test page in apps/dashboard redirects unauthenticated users to a sign-in page.",
      "After authentication, getServerSession (via apps/dashboard/lib/auth.ts) returns a valid session with a user id that matches the DB.",
      "Auth is fully contained in apps/dashboard; generator app does not depend on it."
    ],
    "status": "pending"
  },
  {
    "id": "dash-6-dashboard-layout-and-protection",
    "title": "Create dashboard layout and protect /dashboard routes",
    "description": "Implement a shared layout for the dashboard feature area under apps/dashboard/app/(dashboard)/dashboard and ensure all these routes are auth-protected.",
    "context": {
      "goal": "Provide a consistent, authenticated entry point for user-specific dashboard features, fully separated from report generation runtime.",
      "requirements": [
        "Define a layout at apps/dashboard/app/(dashboard)/dashboard/layout.tsx using shadcn/ui.",
        "Protect all routes under /dashboard using server-side session checks.",
        "Include navigation links for Feeds, Reports, Saved."
      ]
    },
    "dependencies": ["dash-5-setup-authjs", "dash-2-install-shadcn"],
    "artifacts": [
      { "path": "apps/dashboard/app/(dashboard)/dashboard/layout.tsx", "type": "typescript", "required": true },
      { "path": "apps/dashboard/app/(dashboard)/dashboard/page.tsx", "type": "typescript", "required": true }
    ],
    "commands": [
      {
        "description": "Run dashboard dev server and visit /dashboard",
        "run": "cd apps/dashboard && npm run dev"
      }
    ],
    "verification": [
      "Unauthenticated access to /dashboard leads to sign-in.",
      "Authenticated access renders the dashboard layout with navigation.",
      "No code under apps/generator is imported by the dashboard layout."
    ],
    "status": "pending"
  },
  {
    "id": "dash-7-data-layer-modules",
    "title": "Create dashboard data access modules under apps/dashboard/lib/data",
    "description": "Implement thin data access modules for the dashboard app that wrap Prisma calls imported from packages/db and always scope data by userId.",
    "context": {
      "goal": "Provide a clean data layer for the dashboard that does not rely on generator internals and can run independently.",
      "requirements": [
        "Modules live under apps/dashboard/lib/data/*.ts.",
        "All functions accept a userId and use packages/db client.",
        "Support operations for users, sources, reports, saved items."
      ]
    },
    "dependencies": ["dash-4-integrate-prisma-in-dashboard"],
    "artifacts": [
      { "path": "apps/dashboard/lib/data/users.ts", "type": "typescript", "required": false },
      { "path": "apps/dashboard/lib/data/sources.ts", "type": "typescript", "required": true },
      { "path": "apps/dashboard/lib/data/reports.ts", "type": "typescript", "required": true },
      { "path": "apps/dashboard/lib/data/saved-items.ts", "type": "typescript", "required": true }
    ],
    "commands": [],
    "verification": [
      "Each data function imports the Prisma client from packages/db, not from apps/generator.",
      "Each function takes userId as a parameter and filters by it.",
      "Simple test calls from a temporary route work without error."
    ],
    "status": "pending"
  },
  {
    "id": "dash-8-api-feeds-crud",
    "title": "Implement feeds CRUD API routes under apps/dashboard/app/api/feeds",
    "description": "Create REST-like API endpoints to manage SourceConfig records for the authenticated user, under apps/dashboard/app/api/feeds, using the dashboard data layer and shared DB client.",
    "context": {
      "goal": "Enable the dashboard UI to manage feeds/searches through dedicated API routes, independent from generator internals.",
      "requirements": [
        "Endpoints at apps/dashboard/app/api/feeds/route.ts and apps/dashboard/app/api/feeds/[id]/route.ts.",
        "Use Auth helpers to get userId; delegate DB work to apps/dashboard/lib/data/sources.ts."
      ]
    },
    "dependencies": ["dash-5-setup-authjs", "dash-7-data-layer-modules"],
    "artifacts": [
      { "path": "apps/dashboard/app/api/feeds/route.ts", "type": "typescript", "required": true },
      { "path": "apps/dashboard/app/api/feeds/[id]/route.ts", "type": "typescript", "required": true },
      { "path": "docs/dashboard-api.md", "type": "markdown", "required_sections": ["Feeds API"] }
    ],
    "commands": [],
    "verification": [
      "GET /api/feeds returns only the authenticated user's feeds.",
      "POST /api/feeds creates a feed tied to that user.",
      "PUT/PATCH/DELETE enforce that the feed belongs to the current user.",
      "No imports from apps/generator appear in these API handlers."
    ],
    "status": "pending"
  },
  {
    "id": "dash-9-page-feeds-management",
    "title": "Implement /dashboard/feeds page for managing feeds",
    "description": "Create a dashboard page at apps/dashboard/app/(dashboard)/dashboard/feeds/page.tsx that lists the user's feeds and provides forms to create and edit them, calling the feeds API.",
    "context": {
      "goal": "Give users a UI to manage their feed/search configuration via the dashboard app only.",
      "requirements": [
        "Use shadcn/ui components for table/list and forms.",
        "Use React Hook Form + Zod for form validation.",
        "Communicate with the feeds API routes for mutations."
      ]
    },
    "dependencies": ["dash-6-dashboard-layout-and-protection", "dash-8-api-feeds-crud"],
    "artifacts": [
      { "path": "apps/dashboard/app/(dashboard)/dashboard/feeds/page.tsx", "type": "typescript", "required": true },
      { "path": "apps/dashboard/components/feed-form.tsx", "type": "typescript", "required": false }
    ],
    "commands": [],
    "verification": [
      "Authenticated users see their feeds listed at /dashboard/feeds.",
      "Creating/editing/deleting feeds updates the DB and refreshes the list.",
      "No generator-specific code is needed to manage feeds from the dashboard."
    ],
    "status": "pending"
  },
  {
    "id": "dash-10-pages-reports-and-details",
    "title": "Implement /dashboard/reports and /dashboard/reports/[reportId] pages",
    "description": "Create dashboard pages to list user reports and view details for a single report, using the data layer in apps/dashboard/lib/data/reports.ts.",
    "context": {
      "goal": "Let users browse historical reports via the dashboard app, backed by the same DB used by the generator.",
      "requirements": [
        "List view at /dashboard/reports with basic report info.",
        "Details view at /dashboard/reports/[reportId] with items, scores, etc."
      ]
    },
    "dependencies": ["dash-6-dashboard-layout-and-protection", "dash-7-data-layer-modules"],
    "artifacts": [
      { "path": "apps/dashboard/app/(dashboard)/dashboard/reports/page.tsx", "type": "typescript", "required": true },
      { "path": "apps/dashboard/app/(dashboard)/dashboard/reports/[reportId]/page.tsx", "type": "typescript", "required": true }
    ],
    "commands": [],
    "verification": [
      "/dashboard/reports shows only reports belonging to the current user.",
      "/dashboard/reports/[reportId] shows report details only if the report belongs to that user.",
      "All data fetching is done via apps/dashboard/lib/data/reports.ts and packages/db."
    ],
    "status": "pending"
  },
  {
    "id": "dash-11-page-saved-items",
    "title": "Implement /dashboard/saved page for saved items",
    "description": "Create a dashboard page at /dashboard/saved where users can see their saved posts, using the data layer for SavedItem joined with FeedItem and related entities.",
    "context": {
      "goal": "Expose SavedItem functionality to dashboard users as a separate page, independent of generator UI.",
      "requirements": [
        "List saved items with titles, sources, and summaries.",
        "Link out to original URLs and relevant report detail pages."
      ]
    },
    "dependencies": ["dash-7-data-layer-modules"],
    "artifacts": [
      { "path": "apps/dashboard/app/(dashboard)/dashboard/saved/page.tsx", "type": "typescript", "required": true }
    ],
    "commands": [],
    "verification": [
      "Users see only their own saved items.",
      "If there are no saved items, an appropriate empty state is shown.",
      "Links work and no generator code is imported."
    ],
    "status": "pending"
  },
  {
    "id": "dash-12-api-ai-helper",
    "title": "Implement AI helper API endpoint under apps/dashboard/app/api/ai",
    "description": "Create an AI helper endpoint (e.g., /api/ai/generate-description) in the dashboard app that uses an AI model to generate content suggestions for form fields.",
    "context": {
      "goal": "Allow the dashboard to offer AI-assisted content generation (e.g., feed descriptions, report intros) via a dedicated API, independent from the generator pipeline.",
      "requirements": [
        "Route under apps/dashboard/app/api/ai/generate-description/route.ts (or similar).",
        "Validate input and return a stable JSON structure with suggested text.",
        "Use auth if personalization is needed."
      ]
    },
    "dependencies": ["dash-5-setup-authjs"],
    "artifacts": [
      { "path": "apps/dashboard/app/api/ai/generate-description/route.ts", "type": "typescript", "required": true }
    ],
    "commands": [],
    "verification": [
      "Unauthenticated requests receive 401/403 if required.",
      "Valid requests return a JSON payload with a suggested text field.",
      "The endpoint does not import any generator-specific modules; AI logic is dashboard-scoped or shared via packages/ai if you create one."
    ],
    "status": "pending"
  },
  {
    "id": "dash-13-ui-ai-buttons",
    "title": "Add AI helper buttons to dashboard forms",
    "description": "Integrate AI helper buttons into relevant dashboard forms (e.g., feed configuration), calling the AI endpoint and populating fields with suggestions.",
    "context": {
      "goal": "Make AI-assisted generation a natural part of the dashboard UX without entangling it with the generator app.",
      "requirements": [
        "Add 'Generate with AI' buttons next to suitable text fields.",
        "Handle loading, success, and error states gracefully.",
        "Use the AI API endpoint under apps/dashboard/app/api/ai."
      ]
    },
    "dependencies": ["dash-9-page-feeds-management", "dash-12-api-ai-helper"],
    "artifacts": [
      { "path": "apps/dashboard/components/feed-form.tsx", "type": "typescript", "required": true }
    ],
    "commands": [],
    "verification": [
      "Clicking the AI button triggers a request to the AI endpoint.",
      "On success, suggested content appears in the form field.",
      "Errors are handled with user-friendly feedback (e.g., toast), and the form remains usable."
    ],
    "status": "pending"
  }
]
